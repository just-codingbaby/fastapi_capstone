import mysql.connector
from app.db_location import connect_to_mysql

loc_node = [
                    [127.1008565722434, 37.396502014449894],
                    [127.10332041039379, 37.358794072637785],
                    [127.1034515341123, 37.33356568720989],
                    [127.10371825319847, 37.282207568764164],
                    [127.10378839595677, 37.268692199713435],
                    [127.10381177258138, 37.26418706952283],
                    [127.10000025955983, 37.220871613416406],
                    [127.09583359115491, 37.21257018267256],
                    [127.09606378065385, 37.18069128191127],
                    [127.09095628389771, 37.16515618993971],
                    [127.0849166721204, 37.141197247014425],
                    [127.1192174917301, 37.09957860692084],
                [127.1303810262686, 37.076033172993704],
[127.1453124272744, 37.01470955711591],
[127.15417441331587, 36.99434172233534],
[127.15925352834235, 36.98342187402131],
[127.18826863839793, 36.877147179016006],
[127.16620375354104, 36.8193716654845],
[127.1666213807959, 36.79974216728726],
[127.19023650476807, 36.76697529740176],
[127.2309875538001, 36.745043810570984],
[127.38303029780384, 36.627080729093386],
[127.4305295251844, 36.56516799699589],
[127.43210220588804, 36.55363043485985],
[127.43020967328724, 36.532986405455695],
[127.42923867327536, 36.51398873766687],
[127.42794983703914, 36.471908653925546],
[127.4197184682824, 36.43852029408191],
[127.41731976383807, 36.429692944186755],
[127.41870756182243, 36.39700720499854]
]

connection = connect_to_mysql()
mycursor = connection.cursor()

def insert_into_thirty(node_name, latitude, longitude):
    sql = "INSERT INTO thirty (노드명, 위도, 경도) VALUES (%s, %s, %s)"
    val = (node_name, latitude, longitude)
    mycursor.execute(sql, val)
    connection.commit()



for node in loc_node:
    latitude = node[1]
    longitude = node[0]

    sql = "SELECT 노드명, 위도, 경도 FROM location WHERE 위도 = %s AND 경도 = %s"
    val = (latitude, longitude)
    mycursor.execute(sql, val)
    result = mycursor.fetchone()

    node_name, latitude, longitude = result
    insert_into_thirty(node_name, latitude, longitude)

mycursor.close()
connection.close()
